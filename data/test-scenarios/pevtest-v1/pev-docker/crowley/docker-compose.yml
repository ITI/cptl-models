version: '3.3'
services:
   crowley-gos-db:
     image: mysql:5.7
     volumes:
       - '/var/lib/mysql:/var/lib/mysql'
     restart: always
     networks:
       crowley-l3:
         ipv4_address: 10.0.0.2
     environment:
       MYSQL_ROOT_PASSWORD: somewordpress
       MYSQL_DATABASE: crowley
       MYSQL_USER: GOS
       MYSQL_PASSWORD: GOS
   crowley-gos-iperf:
     image: iitgdocker/iperf-server:latest
     network_mode: "service:crowley-gos"
     depends_on:
       - crowley-gos
     tty: true
     environment:
       - ARGS=-o /data/iperf.log -u
     volumes:
       - /tmp/iperf-server:/data:rw
   crowley-gos:
     build: ./gos
     links:
       - crowley-gos-db
     ports:
       - "8000:80"
     restart: always
     networks:
       crowley-l3:
         ipv4_address: 10.0.0.9
     tty: true
   crowley-kiosk0:
     image: busybox:latest
     restart: always
     networks:
       crowley-l2:
         ipv4_address: 10.0.1.25
     tty: true
   crowley-kali-l3:
     image: kalilinux/kali-rolling
     restart: always
     tty: true
networks:
  crowley-l2:
      driver: bridge
      driver_opts:
         com.docker.network.bridge.name: "b.2.38"
      ipam:
         driver: default
         config:
           - subnet: 10.0.1.0/24
  crowley-l3:
      driver: bridge
      driver_opts:
         com.docker.network.bridge.name: "b.1.38"
      ipam:
         driver: default
         config:
           - subnet: 10.0.0.0/24 